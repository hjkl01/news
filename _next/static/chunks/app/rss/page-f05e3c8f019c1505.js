(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[875],{5880:function(e,t,s){Promise.resolve().then(s.bind(s,6162))},8030:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var a=s(2265);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:l=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:o="",children:m,iconNode:x,...u}=e;return(0,a.createElement)("svg",{ref:t,...d,width:l,height:l,stroke:s,strokeWidth:n?24*Number(r)/Number(l):r,className:i("lucide",o),...!m&&!c(u)&&{"aria-hidden":"true"},...u},[...x.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])}),m=(e,t)=>{let s=(0,a.forwardRef)((s,r)=>{let{className:c,...d}=s;return(0,a.createElement)(o,{ref:r,iconNode:t,className:i("lucide-".concat(l(n(e))),"lucide-".concat(e),c),...d})});return s.displayName=n(e),s}},4241:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},2421:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},7592:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3787:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},2022:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6162:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(7437),l=s(2265),r=s(8030);let n=(0,r.Z)("rss",[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]),i=(0,r.Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),c=(0,r.Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),d=(0,r.Z)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),o=(0,r.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),m=(0,r.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var x=s(2421),u=s(7592),h=s(2022),p=s(4241),f=s(3787);let y={BATCH_SIZE:3,BATCH_DELAY:100,RSS_PROXY_URL:"https://rsstojson.hjkl01.cn/api/rss",CATEGORY_COLORS:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1","#14B8A6","#F43F5E"]},g={stripHtml:e=>e?e.replace(/<[^>]*>/g,"").trim():"",formatDate:e=>e?new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",truncateText:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return!e||e.length<=t?e:e.substring(0,t)+"..."},generateId:(e,t)=>"".concat(e,"-").concat(Date.now(),"-").concat(t)},b=()=>{let[e,t]=(0,l.useState)({}),[s,a]=(0,l.useState)([]),[r,n]=(0,l.useState)(null),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(null),m=(0,l.useCallback)(async()=>{c(!0),o(null);try{let e=await fetch("/rss-feeds.json");if(!e.ok)throw Error("无法加载RSS配置文件");let t=await e.json();n(t);let s=new Map;t.feeds.forEach((e,t)=>{s.has(e.category)||s.set(e.category,{id:e.category.toLowerCase().replace(/\s+/g,"-"),name:e.category,color:y.CATEGORY_COLORS[t%y.CATEGORY_COLORS.length],count:0})}),a(Array.from(s.values()))}catch(e){o(e instanceof Error?e.message:"加载RSS内容时发生错误")}finally{c(!1)}},[]);return{feedsByCategory:e,categories:s,rssConfig:r,loading:i,error:d,loadCategoriesAndConfig:m,addFeedsToCategory:(0,l.useCallback)((e,s)=>{t(t=>{let a=t[e]||[];return{...t,[e]:[...a,...s]}})},[]),clearCategoryFeeds:(0,l.useCallback)(e=>{t(t=>({...t,[e]:[]}))},[]),clearAllFeeds:(0,l.useCallback)(()=>{t({})},[]),setError:o}},v=()=>{let[e,t]=(0,l.useState)(new Set),[s,a]=(0,l.useState)([]),[r,n]=(0,l.useState)(0),i=(0,l.useCallback)(e=>{t(t=>new Set(t).add(e))},[]),c=(0,l.useCallback)(e=>{t(t=>{let s=new Set(t);return s.delete(e),s})},[]);return{loadingFeeds:e,failedFeeds:s,loadedFeedsCount:r,addLoadingFeed:i,removeLoadingFeed:c,addFailedFeed:(0,l.useCallback)(e=>{a(t=>[...t,e])},[]),incrementLoadedCount:(0,l.useCallback)(()=>{n(e=>e+1)},[]),resetLoadingState:(0,l.useCallback)(()=>{t(new Set),a([]),n(0)},[])}},j=async(e,t)=>{try{var s,a,l,r,n;let i="".concat(y.RSS_PROXY_URL,"?url=").concat(encodeURIComponent(e.url)),c=await fetch(i);if(!c.ok)throw Error("HTTP ".concat(c.status));let d=await c.json(),o=[],m="";if("ok"===d.status&&d.items?(o=d.items,m=(null===(r=d.feed)||void 0===r?void 0:r.title)||(null===(n=d.feed)||void 0===n?void 0:n.name)||""):Array.isArray(d)?o=d:(null===(a=d.rss)||void 0===a?void 0:null===(s=a.channel)||void 0===s?void 0:s.item)?(o=Array.isArray(d.rss.channel.item)?d.rss.channel.item:[d.rss.channel.item],m=d.rss.channel.title||d.rss.channel.name||""):(null===(l=d.feed)||void 0===l?void 0:l.entry)?(o=Array.isArray(d.feed.entry)?d.feed.entry:[d.feed.entry],m=d.feed.title||d.feed.name||""):d.items&&Array.isArray(d.items)&&(o=d.items,m=d.title||d.name||""),o&&o.length>0)return o.map((s,a)=>{let l=s.title||s.name||"无标题",r=s.description||s.content||s.summary||"无描述",n=s.link||s.url||"#",i=s.pubDate||s.published||s.updated||s.date||Date.now(),c=s.author||s.creator||m||e.title||e.name;return{id:g.generateId(e.title||e.name,a),title:"string"==typeof l?l:(null==l?void 0:l._text)||(null==l?void 0:l._cdata)||"无标题",description:g.stripHtml("string"==typeof r?r:(null==r?void 0:r._text)||(null==r?void 0:r._cdata)||"无描述"),link:"string"==typeof n?n:(null==n?void 0:n._text)||(null==n?void 0:n._cdata)||"#",pubDate:new Date(i),category:t,source:m||e.title||e.name,author:"string"==typeof c?c:(null==c?void 0:c._text)||(null==c?void 0:c._cdata)||e.title||e.name,feedName:e.title||e.name}});return null}catch(t){return console.error("Error fetching RSS feed ".concat(e.title||e.name,":"),t),null}};function w(){let{feedsByCategory:e,categories:t,rssConfig:s,loading:r,error:w,loadCategoriesAndConfig:N,addFeedsToCategory:k,clearCategoryFeeds:C,clearAllFeeds:S,setError:A}=b(),{loadingFeeds:E,failedFeeds:Z,loadedFeedsCount:_,addLoadingFeed:R,removeLoadingFeed:L,addFailedFeed:M,incrementLoadedCount:O,resetLoadingState:T}=v(),[B,D]=(0,l.useState)(null),[F,H]=(0,l.useState)(new Set),[q,z]=(0,l.useState)(!1);(0,l.useEffect)(()=>{N()},[N]),(0,l.useEffect)(()=>{if(t.length>0&&null===B){let e=t[0];D(e.id),I(e.id)}},[t,B]);let I=(0,l.useCallback)(async e=>{if(s){A(null),C(e),T();try{let a=t.find(t=>t.id===e);if(!a)throw Error("分类不存在");let l=s.feeds.filter(t=>t.category.toLowerCase().replace(/\s+/g,"-")===e);for(let t=0;t<l.length;t+=y.BATCH_SIZE)l.slice(t,t+y.BATCH_SIZE).forEach(async t=>{R(t.title);try{let s=await j(t,a);s&&s.length>0?(k(e,s),H(e=>new Set(e).add(t.title)),O()):M(t.title)}catch(e){console.error(e),M(t.title)}finally{L(t.title)}}),t+y.BATCH_SIZE<l.length&&await new Promise(e=>setTimeout(e,y.BATCH_DELAY))}catch(e){A(e instanceof Error?e.message:"加载RSS内容时发生错误")}}},[s,t,k,C,T,R,L,M,O,A]),Y=(0,l.useCallback)(async t=>{D(t),z(!1),e[t]&&0!==e[t].length?H(new Set(e[t].map(e=>e.feedName))):await I(t)},[e,I]),U=(0,l.useCallback)(async()=>{S(),T(),z(!1),B&&await I(B)},[B,S,T,I]),P=(0,l.useCallback)(()=>{B&&(setFeedsByCategory(e=>{let t=[...e[B]||[]].sort((e,t)=>t.pubDate.getTime()-e.pubDate.getTime());return{...e,[B]:t}}),z(!0))},[B]),G=(0,l.useCallback)(e=>{H(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),W=(0,l.useCallback)(()=>{let e=Object.keys(X);H(t=>t.size===e.length?new Set:new Set(e))},[]),V=(0,l.useMemo)(()=>B&&e[B]||[],[B,e]),X=(0,l.useMemo)(()=>V.reduce((e,t)=>(e[t.feedName]||(e[t.feedName]=[]),e[t.feedName].push(t),e),{}),[V]),$=r||E.size>0;return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-2 rounded-lg",children:(0,a.jsx)(n,{className:"w-6 h-6 text-white"})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"RSS订阅阅读器"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{onClick:W,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg flex items-center space-x-2 transition-all duration-200",children:(0,a.jsx)("span",{children:F.size===Object.keys(X).length?"收起全部":"展开全部"})}),Object.keys(X).length>0&&(0,a.jsxs)("button",{onClick:P,disabled:q,className:"px-4 py-2 rounded-lg flex items-center space-x-2 transition-all duration-200 ".concat(q?"bg-green-100 text-green-700 cursor-not-allowed":"bg-orange-100 hover:bg-orange-200 text-orange-700"),children:[(0,a.jsx)(i,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:q?"已按时间排序":"按时间排序"})]}),(0,a.jsxs)("button",{onClick:U,disabled:$,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-all duration-200 transform hover:scale-105",children:[(0,a.jsx)(c,{className:"w-4 h-4 ".concat($?"animate-spin":"")}),(0,a.jsx)("span",{children:"刷新内容"})]})]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 sticky top-8",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(d,{className:"w-5 h-5 mr-2 text-blue-500"}),"分类"]}),(0,a.jsx)("div",{className:"space-y-2",children:t.map(t=>{var s;return(0,a.jsxs)("button",{onClick:()=>Y(t.id),className:"w-full text-left px-4 py-3 rounded-lg transition-all duration-200 flex items-center justify-between ".concat(B===t.id?"shadow-lg text-white":"text-gray-700 hover:bg-gray-50"),style:{backgroundColor:B===t.id?t.color:"transparent"},children:[(0,a.jsx)("span",{className:"font-medium",children:t.name}),(0,a.jsx)("span",{className:"text-sm px-2 py-1 rounded-full",style:{backgroundColor:B===t.id?"rgba(255, 255, 255, 0.2)":t.color+"20",color:B===t.id?"white":t.color},children:(null===(s=e[t.id])||void 0===s?void 0:s.length)||0})]},t.id)})})]})}),(0,a.jsxs)("div",{className:"lg:col-span-3",children:[w&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6 flex items-center space-x-3",children:[(0,a.jsx)(o,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-800 font-medium",children:"加载错误"}),(0,a.jsx)("p",{className:"text-red-600 text-sm",children:w})]})]}),Z.length>0&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(o,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-yellow-800 font-medium",children:"部分RSS源加载失败"})]}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm mb-2",children:"以下RSS源暂时无法访问："}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[Z.slice(0,5).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:e},t)),Z.length>5&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:["+",Z.length-5," 更多"]})]})]}),$?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"正在动态加载RSS内容..."}),_>0&&(0,a.jsxs)("p",{className:"text-sm text-green-600 mt-2 flex items-center justify-center",children:[(0,a.jsx)(m,{className:"w-4 h-4 mr-1"}),"已成功加载 ",_," 个RSS源"]})]}),E.size>0&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"正在动态加载RSS源："}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(E).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-500"}),(0,a.jsx)("span",{children:e})]},t))}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"内容将实时显示，无需等待所有加载完成。新内容会追加到列表末尾，不影响已有内容的查看。"})]})]}):(0,a.jsx)("div",{className:"space-y-6",children:0===Object.entries(X).length?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[(0,a.jsx)(n,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"暂无RSS内容"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"该分类下暂无内容或加载失败"}),(0,a.jsx)("button",{onClick:U,className:"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-6 py-3 rounded-lg transition-all duration-200 transform hover:scale-105",children:"重新加载"})]}):Object.entries(X).map(e=>{var t,s;let[l,r]=e,n=F.has(l),i=(null===(t=r[0])||void 0===t?void 0:t.category.color)||"#3B82F6";return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 cursor-pointer hover:bg-opacity-90 transition-all duration-200",style:{backgroundColor:i+"10"},onClick:()=>G(l),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:i},children:l.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:l}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[r.length," 篇文章"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:i},children:null===(s=r[0])||void 0===s?void 0:s.category.name}),n?(0,a.jsx)(x.Z,{className:"w-5 h-5 text-gray-500"}):(0,a.jsx)(u.Z,{className:"w-5 h-5 text-gray-500"})]})]})}),n&&(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:r.map(e=>(0,a.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors duration-200",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{className:"w-2 h-16 rounded-full flex-shrink-0",style:{backgroundColor:i}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 line-clamp-3",children:g.truncateText(e.description)}),(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"truncate max-w-32",children:e.author})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:g.formatDate(e.pubDate)})]})]}),(0,a.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 font-medium transition-colors duration-200 hover:underline",style:{color:i},children:[(0,a.jsx)("span",{children:"阅读全文"}),(0,a.jsx)(f.Z,{className:"w-4 h-4"})]})]})]})]})},e.id))})]},l)})})]})]})})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=5880)}),_N_E=e.O()}]);